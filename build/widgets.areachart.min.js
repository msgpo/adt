(function(t,a){if(typeof exports==="object"&&typeof module!=="undefined"){a(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],a)}else{a(t.adt=t.adt||{})}})(this,function(t){"use strict";if(t.widgets){var a=t.widgets}else{throw new Error("adt.widgets.areachart Error: widgets module is not exported")}function r(t,r){var e=a.Widget.call(this,t,"areaChart","svg",r);e.attr.add(this,"xLabel","");e.attr.add(this,"yLabel","");e.attr.add(this,"xType","number");e.attr.add(this,"yTickFormat",d3.format(".2s"));e.attr.add(this,"colors","grey");e.attr.add(this,"opacity",.3);e.attr.add(this,"yMin",0);var i=null;var s=[];var n=1;this.data=function(t,a){s=_.cloneDeep(t);if(e.attr.xType==="number"||e.attr.xType==="time"){s.sort(function(t,a){return t.x-a.x})}if(typeof a==="number"&&a>0)n=a;return this};this.highlight=function(t){e.utils.highlight(i,".area",t)};e.render.build=function(){if(i!==null)return;i={};i.g=e.widget.append("g");i.axisFn={x:d3.axisBottom().ticks(7),y:d3.axisLeft().ticks(5).tickFormat(e.attr.yTickFormat)};i.axes={x:i.g.append("g").attr("class","x axis"),y:i.g.append("g").attr("class","y axis")};i.labels={x:i.g.append("text").attr("class","x axis-label").attr("text-anchor","end").attr("stroke-width",0),y:i.g.append("text").attr("class","y axis-label").attr("text-anchor","begin").attr("stroke-width",0)};i.areas={};_.forOwn(s[0].y,function(t,a){i.areas[a]=i.g.append("path").attr("class","area "+e.utils.encode(a)).style("fill-opacity",e.attr.opacity).style("shape-rendering","geometricPrecision")})};e.render.update=function(t){var a=_.cloneDeep(s);for(var r=0;r<a.length;r++){for(var o in a[r].y){if(a[r].y.hasOwnProperty(o))a[r].y[o]/=n}}var l=e.utils.scale(e.utils.boundary(a),e.attr.width-e.attr.margins.left-e.attr.margins.right,e.attr.height-e.attr.margins.top-e.attr.margins.bottom,{x:{type:e.attr.xType}});i.axes.x.transition().duration(t).call(i.axisFn.x.scale(l.x));i.axes.y.transition().duration(t).call(i.axisFn.y.scale(l.y));_.forOwn(a[0].y,function(r,s){var n=d3.area().x(function(t){return l.x(t.x)+1}).y0(e.attr.height-e.attr.margins.top-e.attr.margins.bottom-1).y1(function(t){return l.y(t.y[s])});i.g.select("."+e.utils.encode(s)).transition().duration(t).attr("d",n(a))})};e.render.style=function(){var t=e.attr.width-e.attr.margins.left-e.attr.margins.right,a=e.attr.height-e.attr.margins.top-e.attr.margins.bottom;i.g.attr("width",t+"px").attr("height",a+"px").attr("transform","translate("+e.attr.margins.left+","+e.attr.margins.top+")").style("pointer-events","all");i.axes.x.attr("transform","translate(0,"+a+")");i.axisFn.y.tickFormat(e.attr.yTickFormat);i.axes.y.attr("transform","translate(0,"+1+")");i.g.selectAll(".axis path").style("fill","none").style("stroke",e.attr.fontColor).style("stroke-width","2px").style("shape-rendering","crispEdges");i.g.selectAll(".tick > line").style("stroke",e.attr.fontColor).style("stroke-width","2px");i.g.selectAll(".tick > text").attr("stroke-width",0).style("font-size",e.attr.fontSize+"px").style("fill",e.attr.fontColor);i.labels.x.attr("x",t+"px").attr("y",a+35+"px").style("font-size",e.attr.fontSize+"px").style("fill",e.attr.fontColor).text(e.attr.xLabel);i.labels.y.attr("x",5+"px").attr("y",-5+"px").style("font-size",e.attr.fontSize+"px").style("fill",e.attr.fontColor).text(e.attr.yLabel);_.forOwn(i.areas,function(t,a){i.areas[a].style("fill",typeof e.attr.colors==="string"?e.attr.colors:e.attr.colors[a])});e.widget.style("display","block")}}r.prototype=Object.create(a.Widget.prototype);t.widgets.AreaChart=r});