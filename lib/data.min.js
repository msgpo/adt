(function(n,t){if(typeof exports==="object"&&typeof module!=="undefined"){t(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],t)}else{t(n.adt=n.adt||{})}})(this,function(n){"use strict";var t={si:function(){var n="yzafpnÎ¼m kMGTPEZY";var t=(n.length-1)/2;var r=t;var e=-t;function u(u){if(u===null||u===undefined||isNaN(u))return"N/A";if(u===0)return"0";var i=Math.abs(u);var o=Math.max(Math.min(parseInt(Math.floor(Math.log(i)/Math.log(1e3))),r),e);var a=i/Math.pow(1e3,o);return(u<0?"-":"")+(o===e||o===r?a.toExponential(2):a.toPrecision(3)).replace(/e\+0$/,"")+n.charAt(t+o).trim()}return u}(),idfy:function(n){return n?n.replace(/ /g,"__"):""},namify:function(n){return n?n.replace(/__/g," "):""}};var r={sum:function(n,t,r){var e={};var u=[];if(Array.isArray(r)){u=r}else{u=[r]}var i=u.length;n.forEach(function(n){var r=[];u.forEach(function(t){if(n.hasOwnProperty(t)){r.push(n[t])}});if(r.length!==i)return;var o=r.join(".");if(!e.hasOwnProperty(o))e[o]=+n[t];else e[o]+=+n[t]});var o=[];_.forOwn(e,function(n,t){o.push({key:t,value:n})});return o.sort(function(n,t){return t.value-n.value})}};var e={Histogram:function(n){var t=n?n:[];this.set=function(n){t=n;return this};function r(){return _.cloneDeep(t)}function e(n,r){t.push({x:n,y:r,index:t.length});return this}function u(n){t.forEach(function(t){t.y*=n});return this}function i(){var n=d3.sum(t,function(n){return n.y});t.forEach(function(t){t.y/=n});return this}function o(n){t.sort(function(t,r){return n?r.x-t.x:t.x-r.x});return this}function a(n){t.sort(function(t,r){return n?r.y-t.y:t.y-r.y});return this}function f(){t.sort(function(n,t){return n.index-t.index});return this}return{set:set,get:r,add:e,scale:u,normalize:i,sortByX:o,sortByY:a,unsort:f}},TimeSeries:function(n){var t=[];function r(r){t=[];var e=0;if(r!==null){var u=new Date(r);while(u<=new Date){t.push({x:new Date(u),y:{}});n.forEach(function(n){t[e].y[n]=0});u.setDate(u.getDate()+1);e++}}return this}function e(n, r, e, u){t[n].x=r;t[n].y[e]+=u}function u(n, r){if(!n)return t;else{var e=r?r:0;return t.slice(-e-n,-e)}}function i(n, r){if(t.length<1)return{};var e={};_.forOwn(t[0].y,function(n, t){e[t]=0});u(n?n:1,r).forEach(function(n){_.forOwn(t[0].y,function(t, r){e[r]+=n.y[r]})});return e}function o(n,r){var e=0;if(t.length>0){var i=u(n,r);_.forOwn(t[0].y,function(n,t){e=Math.max(d3.max(i,function(n){return n.y.hasOwnProperty(t)?n.y[t]:0}),e)})}return e}function a(n){if(t.length<1)return{};var r=i(1,n);var e=i(2,n);var u={};_.forOwn(t[0].y,function(n,t){e[t]-=r[t];if(e[t]>=10&&r[t]>0){u[t]=(r[t]-e[t])/e[t]}});return u}function f(n,t){var r=i(n,t);var e=0;_.forOwn(r,function(n){e+=n});_.forOwn(r,function(n,t){r[t]/=e>0?e:1});return r}return{clear:r,update:e,sub:u,sum:i,peak:o,trend:a,yDist:f}},Table:function(n){var t=[];var r=[];if(n){t=_.cloneDeep(n);t.forEach(function(n,t){r.push(t)})}function e(n,r){var e=[];t.forEach(function(t){var u;if(typeof r==="string"){u=t[r]}else{u={};r.forEach(function(n){u[n]=t[n]})}e.push({x:t[n],y:u})});return e}function u(n,r){var e=null;switch(typeof r){case"number":var u=d3.min(t,function(t){return Math.abs((r-t[n])/r)});e=t.filter(function(t){return Math.abs((t[n]-r)/r)<=u*1.01});break;case"string":default:e=t.filter(function(t){return t[n]===r})}return new adt.data.structures.Table(e)}function i(n){t.sort(function(t,r){return t[n]-r[n]})}function o(){var n=[];r.forEach(function(r){n.push(t[r])});t=n}return{slice:e,segment:u,sort:i,unsort:o}}};if(!n.data)var u=n.data={};u.format=t;u.explore=r;u.structures=e});