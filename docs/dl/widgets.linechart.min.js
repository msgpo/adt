(function(t,r){if(typeof exports==="object"&&typeof module!=="undefined"){r(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],r)}else{r(t.adt=t.adt||{})}})(this,function(t){"use strict";if(t.widgets){var r=t.widgets}else{throw new Error("adt.widgets.linechart Error: widgets module is not exported")}function e(t,e){var a=r.Widget.call(this,t,"lineChart","svg",e);a.attr.add(this,"xLabel","");a.attr.add(this,"yLabel","");a.attr.add(this,"xType","number");a.attr.add(this,"yTickFormat",d3.format(".2s"));a.attr.add(this,"colors","grey");a.attr.add(this,"yMin",0);var i=null;var n=[];var s=1;this.data=function(t,r){n=_.cloneDeep(t);if(a.attr.xType==="number"||a.attr.xType==="time"){n.sort(function(t,r){return t.x-r.x})}if(typeof r==="number"&&r>0)s=r;return this};this.highlight=function(t){a.utils.highlight(i,".line",t)};a.render.build=function(){if(i!==null)return;i={};i.g=a.widget.append("g");i.axisFn={x:d3.axisBottom().ticks(7),y:d3.axisLeft().ticks(5).tickFormat(a.attr.yTickFormat)};i.axes={x:i.g.append("g").attr("class","x axis").attr("font-family","inherit"),y:i.g.append("g").attr("class","y axis").attr("font-family","inherit")};i.labels={x:i.g.append("text").attr("class","x axis-label").attr("text-anchor","end").attr("font-family","inherit").attr("stroke-width",0),y:i.g.append("text").attr("class","y axis-label").attr("text-anchor","begin").attr("font-family","inherit").attr("stroke-width",0)};i.errors={};_.forOwn(n[0].y,function(t,r){i.errors[r]=i.g.append("path").attr("class","error "+a.utils.encode(r)).style("fill-opacity",.2).style("stroke-width","0px").style("shape-rendering","geometricPrecision")});i.lines={};_.forOwn(n[0].y,function(t,r){i.lines[r]=i.g.append("path").attr("class","line "+a.utils.encode(r)).style("fill","none").style("stroke-width","2px").style("shape-rendering","geometricPrecision")})};a.render.update=function(t){var r=_.cloneDeep(n);for(var e=0;e<r.length;e++){for(var o in r[e].y){if(r[e].y.hasOwnProperty(o))r[e].y[o]/=s;if(r[e].hasOwnProperty("dy")){if(r[e].dy.hasOwnProperty(o))r[e].dy[o]/=s}}}var l=a.utils.scale(a.utils.boundary(r,{y:[a.attr.yMin,null]}),a.attr.width-a.attr.margins.left-a.attr.margins.right,a.attr.height-a.attr.margins.top-a.attr.margins.bottom,{x:{type:a.attr.xType}});i.axes.x.transition().duration(t).call(i.axisFn.x.scale(l.x));i.axes.y.transition().duration(t).call(i.axisFn.y.scale(l.y));_.forOwn(r[0].y,function(e,a){if(r[0].hasOwnProperty("dy")&&r[0].dy.hasOwnProperty(a)){var n=d3.area().x(function(t){return l.x(t.x)+2}).y0(function(t){return l.y(t.y[a]-t.dy[a])}).y1(function(t){return l.y(t.y[a]+t.dy[a])});i.errors[a].transition().duration(t).attr("d",n(r))}var s=d3.line().x(function(t){return l.x(t.x)+2}).y(function(t){return l.y(t.y[a])});i.lines[a].transition().duration(t).attr("d",s(r))})};a.render.style=function(){var t=a.attr.width-a.attr.margins.left-a.attr.margins.right,r=a.attr.height-a.attr.margins.top-a.attr.margins.bottom;i.g.attr("width",t+"px").attr("height",r+"px").attr("transform","translate("+a.attr.margins.left+","+a.attr.margins.top+")").style("pointer-events","all");i.axes.x.attr("transform","translate(0,"+r+")");i.axisFn.y.tickFormat(a.attr.yTickFormat);i.axes.y.attr("transform","translate(0,"+1+")");i.g.selectAll(".axis path").style("fill","none").style("stroke",a.attr.fontColor).style("stroke-width","2px").style("shape-rendering","crispEdges");i.g.selectAll(".tick > line").style("stroke",a.attr.fontColor).style("stroke-width","2px");i.g.selectAll(".tick > text").attr("stroke-width",0).style("font-size",a.attr.fontSize+"px").style("fill",a.attr.fontColor);i.labels.x.attr("x",t+"px").attr("y",r+35+"px").style("font-size",a.attr.fontSize+"px").style("fill",a.attr.fontColor).text(a.attr.xLabel);i.labels.y.attr("x",5+"px").attr("y",-5+"px").style("font-size",a.attr.fontSize+"px").style("fill",a.attr.fontColor).text(a.attr.yLabel);_.forOwn(i.errors,function(t,r){i.errors[r].style("fill",typeof a.attr.colors==="string"?a.attr.colors:a.attr.colors[r])});_.forOwn(i.lines,function(t,r){i.lines[r].style("stroke",typeof a.attr.colors==="string"?a.attr.colors:a.attr.colors[r])});a.widget.style("display","block")}}e.prototype=Object.create(r.Widget.prototype);t.widgets.LineChart=e});